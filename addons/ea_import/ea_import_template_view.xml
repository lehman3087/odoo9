<?xml version="1.0"?>
<openerp>
    <data>

        <record model="ir.ui.view" id="ea_import_template_tree">
            <field name="name">ea_import.template.tree</field>
            <field name="model">ea_import.template</field>
            <field name="type">tree</field>
            <field name="arch" type="xml">
                <tree string="Import Template">
                    <field name="name"/>
                    <field name="target_model_id"/>
                    <field name="test_input_file"/>
                    <field name="update"/>
                    <field name="update_current"/>
                    <field name="create_new"/>
                    <field name="chain_id"/>
                    <field name="sequence"/>
                    <field name="post_import_hook"/>
                    <field name="line_ids" nolabel="1"/>
                </tree>
            </field>
        </record>

        <record model="ir.ui.view" id="ea_import_template_form">
            <field name="name">ea_import.template.form</field>
            <field name="model">ea_import.template</field>
            <field name="type">form</field>
            <field name="arch" type="xml">
                <form string="ea_orders Update History" col="8">
                    <group colspan="2" col="4">
                        <field name="name" colspan="4"/>
                        <field name="target_model_id" colspan="4"/>
                        <field name="chain_id"/>
                        <field name="sequence"/>
                        <field name="post_import_hook" colspan="4"/>
                        <separator colspan="4"/>
                        <field name="update" colspan="2" attrs="{'invisible': [('create_unique_only','!=',False)]}"/>
                        <field name="update_current" colspan="2" attrs="{'invisible': ['|',('update', '=', False),('create_unique_only','!=',False)]}"/>
                        <field name="create_new" colspan="2"/>
                        <field name="create_unique_only" colspan="2" attrs="{'invisible': [('create_new', '=', False)]}"/>
                        <field name="matching_rules_ids" attrs="{'invisible': [('create_unique_only', '=', False)]}" nolabel="1" colspan="4">
                            <form string="Matching Rules">
                                <field name="template_id" invisible="1"/>
                                <field name="source_model_id" invisible="1"/>
                                <field name="source_field_id" domain="[('model_id','=',source_model_id)]" attrs="{'readonly': [('source_model_id', '=', False)]}"/>
                                <field name="comparison_model_id" on_change="onchange_model_id(comparison_model_id)"/>
                                <field name="target_field_id" domain="[('model_id','=',comparison_model_id)]"/>
                            </form>
                            <tree string="Matching Rules" editable="bottom">
                                <field name="template_id" invisible="1"/>
                                <field name="source_model_id" invisible="1"/>
                                <field name="source_field_id" domain="[('model_id','=',source_model_id)]" attrs="{'readonly': [('source_model_id', '=', False)]}"/>
                                <field name="comparison_model_id" on_change="onchange_model_id(comparison_model_id)"/>
                                <field name="target_field_id" domain="[('model_id','=',comparison_model_id)]" on_change="onchange_target_field_id(target_field_id)"/>
                            </tree>
                        </field>
                    </group>
                    <group colspan="6">
                        <field name="line_ids" nolabel="1" colspan="8" height="300" context="{'template_id': active_id, 'target_model_id': target_model_id}"/>
                    </group>
                </form>
            </field>
        </record>
        
        <record model="ir.ui.view" id="ea_import_template_filter">
            <field name="name">ea_import.template.filter</field>
            <field name="model">ea_import.template</field>
            <field name="type">search</field>
            <field name="arch" type="xml">
                <search string="Templates">
                    <field name="name"/>
                    <field name="target_model_id"/>
                    <field name="chain_id"/>
                </search>
            </field>
        </record>

        <record model="ir.actions.act_window" id="ea_import_template_action">
            <field name="name">Import Tool</field>
            <field name="res_model">ea_import.template</field>
            <field name="view_mode">tree,form</field>
            <field name="view_type">form</field>
            <field name="view_id" ref="ea_import_template_tree"/>
            <field name="search_view_id" ref="ea_import_template_filter"/>
            <field name="target">current</field>
        </record>        


        <menuitem name="Import Tool" id="ea_import_menu" parent="base.menu_administration"/>
        <menuitem name="Templates" id="ea_import_template_menu" parent="ea_import_menu" action="ea_import_template_action"/>
    </data>
</openerp>
